THREE.MTLLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(b,d,g,e){var c=this;var f=(this.path===undefined)?THREE.LoaderUtils.extractUrlBase(b):this.path;var a=new THREE.FileLoader(this.manager);a.setPath(this.path);a.load(b,function(h){d(c.parse(h,f))},g,e)},setPath:function(a){this.path=a;return this},setResourcePath:function(a){this.resourcePath=a;return this},setTexturePath:function(a){console.warn("THREE.MTLLoader: .setTexturePath() has been renamed to .setResourcePath().");return this.setResourcePath(a)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setMaterialOptions:function(a){this.materialOptions=a;return this},parse:function(j,l){var m=j.split("\n");var b={};var c=/\s+/;var a={};for(var d=0;d<m.length;d++){var n=m[d];n=n.trim();if(n.length===0||n.charAt(0)==="#"){continue}var f=n.indexOf(" ");var h=(f>=0)?n.substring(0,f):n;h=h.toLowerCase();var g=(f>=0)?n.substring(f+1):"";g=g.trim();if(h==="newmtl"){b={name:g};a[g]=b}else{if(h==="ka"||h==="kd"||h==="ks"||h==="ke"){var k=g.split(c,3);b[h]=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])]}else{b[h]=g}}}var e=new THREE.MTLLoader.MaterialCreator(this.resourcePath||l,this.materialOptions);e.setCrossOrigin(this.crossOrigin);e.setManager(this.manager);e.setMaterials(a);return e}};THREE.MTLLoader.MaterialCreator=function(b,a){this.baseUrl=b||"";this.options=a;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=(this.options&&this.options.side)?this.options.side:THREE.FrontSide;this.wrap=(this.options&&this.options.wrap)?this.options.wrap:THREE.RepeatWrapping};THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(a){this.crossOrigin=a;return this},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(a){if(!this.options){return a}var h={};for(var c in a){var i=a[c];var g={};h[c]=g;for(var b in i){var d=true;var f=i[b];var e=b.toLowerCase();switch(e){case"kd":case"ka":case"ks":if(this.options&&this.options.normalizeRGB){f=[f[0]/255,f[1]/255,f[2]/255]}if(this.options&&this.options.ignoreZeroRGBs){if(f[0]===0&&f[1]===0&&f[2]===0){d=false}}break;default:break}if(d){g[e]=f}}}return h},preload:function(){for(var a in this.materialsInfo){this.create(a)}},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var b in this.materialsInfo){this.materialsArray[a]=this.create(b);this.nameLookup[b]=a;a++}return this.materialsArray},create:function(a){if(this.materials[a]===undefined){this.createMaterial_(a)}return this.materials[a]},createMaterial_:function(g){var i=this;var h=this.materialsInfo[g];var c={name:g,side:this.side};function d(k,j){if(typeof j!=="string"||j===""){return""}if(/^https?:\/\//i.test(j)){return j}return k+j}function e(k,j){if(c[k]){return}var m=i.getTextureParams(j,c);var l=i.loadTexture(d(i.baseUrl,m.url));l.repeat.copy(m.scale);l.offset.copy(m.offset);l.wrapS=i.wrap;l.wrapT=i.wrap;c[k]=l}for(var a in h){var f=h[a];var b;if(f===""){continue}switch(a.toLowerCase()){case"kd":c.color=new THREE.Color().fromArray(f);break;case"ks":c.specular=new THREE.Color().fromArray(f);break;case"ke":c.emissive=new THREE.Color().fromArray(f);break;case"map_kd":e("map",f);break;case"map_ks":e("specularMap",f);break;case"map_ke":e("emissiveMap",f);break;case"norm":e("normalMap",f);break;case"map_bump":case"bump":e("bumpMap",f);break;case"map_d":e("alphaMap",f);c.transparent=true;break;case"ns":c.shininess=parseFloat(f);break;case"d":b=parseFloat(f);if(b<1){c.opacity=b;c.transparent=true}break;case"tr":b=parseFloat(f);if(this.options&&this.options.invertTrProperty){b=1-b}if(b>0){c.opacity=1-b;c.transparent=true}break;default:break}}this.materials[g]=new THREE.MeshPhongMaterial(c);return this.materials[g]},getTextureParams:function(c,b){var e={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)};var a=c.split(/\s+/);var d;d=a.indexOf("-bm");if(d>=0){b.bumpScale=parseFloat(a[d+1]);a.splice(d,2)}d=a.indexOf("-s");if(d>=0){e.scale.set(parseFloat(a[d+1]),parseFloat(a[d+2]));a.splice(d,4)}d=a.indexOf("-o");if(d>=0){e.offset.set(parseFloat(a[d+1]),parseFloat(a[d+2]));a.splice(d,4)}e.url=a.join(" ").trim();return e},loadTexture:function(c,b,e,h,g){var f;var a=THREE.Loader.Handlers.get(c);var d=(this.manager!==undefined)?this.manager:THREE.DefaultLoadingManager;if(a===null){a=new THREE.TextureLoader(d)}if(a.setCrossOrigin){a.setCrossOrigin(this.crossOrigin)}f=a.load(c,e,h,g);if(b!==undefined){f.mapping=b}return f}};
